\usepackage{float}
\usepackage{geometry}
\usepackage[T1]{fontenc}

\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{emptypage}
\usepackage{titling}

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}

% Theorem definitions based on Gilles Castel's work: 
% Source: https://github.com/gillescastel/university-setup
\usepackage{thmtools}
\usepackage[framemethod=TikZ]{mdframed}
\mdfsetup{skipabove=1em,skipbelow=0em, innertopmargin=5pt, innerbottommargin=6pt}

\theoremstyle{definition}

\declaretheoremstyle[headfont=\bfseries\sffamily, bodyfont=\normalfont, mdframed={ nobreak } ]{thmbox}
\declaretheoremstyle[headfont=\bfseries\sffamily, bodyfont=\normalfont]{notestyle}
\declaretheoremstyle[headfont=\bfseries\sffamily, bodyfont=\normalfont, numbered=no, mdframed={ rightline=false, topline=false, bottomline=false, }, qed=\qedsymbol ]{thmproofbox}
\declaretheoremstyle[headfont=\bfseries\sffamily, bodyfont=\normalfont, numbered=no, mdframed={ nobreak, rightline=false, topline=false, bottomline=false } ]{thmexplanationbox}

\declaretheorem[numberwithin=chapter, style=thmbox, name=Definición]{definition}
\declaretheorem[sibling=definition, style=thmbox, name=Corolario]{corollary}
\declaretheorem[sibling=definition, style=thmbox, name=Proposición]{prop}
\declaretheorem[sibling=definition, style=thmbox, name=Teorema]{theorem}
\declaretheorem[sibling=definition, style=thmbox, name=Lema]{lemma}

\declaretheorem[numbered=no, style=thmexplanationbox, name=Explicación]{explanation}
\declaretheorem[numbered=no, style=thmproofbox, name=Demostración]{replacementproof}
\declaretheorem[style=notestyle, name=Ejercicio]{ex}
\declaretheorem[style=notestyle,  numbered=no, name=Ejemplo]{eg}
\declaretheorem[style=notestyle, numbered=no, name=Nota]{note}

\renewenvironment{proof}[1][\proofname]{\begin{replacementproof}}{\end{replacementproof}}

\AtEndEnvironment{eg}{\null\hfill$\diamond$}%

\newtheorem*{notation}{Notación}
\newtheorem*{solution}{Solución}
\newtheorem*{observation}{Observación}
\newtheorem*{property}{Propiedad}


% For code syntax highlighting
\usepackage{listings}

% Flexoki colors
% Source: https://stephango.com/flexoki
\definecolor{bgcolor}{RGB}{255, 252, 240}
\definecolor{txcolor}{RGB}{16, 15, 15}
\definecolor{tx2color}{RGB}{111, 110, 105}
\definecolor{grcolor}{RGB}{102, 128, 11}
\definecolor{recolor}{RGB}{175, 48, 41}
\definecolor{cycolor}{RGB}{36, 131, 123}

% Allow for some special characters on listings
\lstset{literate=
  {á}{{\'a}}1 {é}{{\'e}}1 {í}{{\'i}}1 {ó}{{\'o}}1 {ú}{{\'u}}1
  {Á}{{\'A}}1 {É}{{\'E}}1 {Í}{{\'I}}1 {Ó}{{\'O}}1 {Ú}{{\'U}}1
  {à}{{\`a}}1 {è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1
  {À}{{\`A}}1 {È}{{\`E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ù}{{\`U}}1
  {ä}{{\"a}}1 {ë}{{\"e}}1 {ï}{{\"i}}1 {ö}{{\"o}}1 {ü}{{\"u}}1
  {Ä}{{\"A}}1 {Ë}{{\"E}}1 {Ï}{{\"I}}1 {Ö}{{\"O}}1 {Ü}{{\"U}}1
  {â}{{\^a}}1 {ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1
  {Â}{{\^A}}1 {Ê}{{\^E}}1 {Î}{{\^I}}1 {Ô}{{\^O}}1 {Û}{{\^U}}1
  {ã}{{\~a}}1 {ẽ}{{\~e}}1 {ĩ}{{\~i}}1 {õ}{{\~o}}1 {ũ}{{\~u}}1
  {Ã}{{\~A}}1 {Ẽ}{{\~E}}1 {Ĩ}{{\~I}}1 {Õ}{{\~O}}1 {Ũ}{{\~U}}1
  {œ}{{\oe}}1 {Œ}{{\OE}}1 {æ}{{\ae}}1 {Æ}{{\AE}}1 {ß}{{\ss}}1
  {ű}{{\H{u}}}1 {Ű}{{\H{U}}}1 {ő}{{\H{o}}}1 {Ő}{{\H{O}}}1
  {ç}{{\c c}}1 {Ç}{{\c C}}1 {ø}{{\o}}1 {Ø}{{\O}}1 {å}{{\r a}}1 {Å}{{\r A}}1
  {€}{{\euro}}1 {£}{{\pounds}}1 {«}{{\guillemotleft}}1
  {»}{{\guillemotright}}1 {ñ}{{\~n}}1 {Ñ}{{\~N}}1 {¿}{{?`}}1 {¡}{{!`}}1 
}

\lstdefinestyle{flexokistyle}{
  backgroundcolor=\color{bgcolor},
  commentstyle=\color{tx2color},
  keywordstyle=\color{recolor},
  numberstyle=\ttfamily\color{txcolor},
  stringstyle=\color{grcolor},
  identifierstyle=\color{cycolor},
  basicstyle=\ttfamily\footnotesize,
  breakatwhitespace=false,
  breaklines=true,
  captionpos=b,
  keepspaces=true,
  numbers=left,
  numbersep=5pt,
  showspaces=false,
  showstringspaces=false,
  showtabs=false,
  tabsize=4,
}
\lstset{style=flexokistyle}

\renewcommand\qedsymbol{$\blacksquare$}


% Customize headers
\usepackage{fancyhdr}
\pagestyle{fancy}

\fancyhf{}
\newcommand{\changefont}{%
	\fontsize{9}{11}\selectfont
}
\fancyhead[LO]{\changefont \slshape \rightmark} %section
\fancyhead[RE]{\changefont \slshape \leftmark} %chapter
\fancyhead[LE, RO]{\changefont \thepage} %chapter


% 'dedication' environment: To add a dedication paragraph at the start of book
% Source: http://www.tug.org/pipermail/texhax/2010-June/015184.html
\newenvironment{dedication}
{
    \cleardoublepage
    \thispagestyle{empty}
    \vspace*{\stretch{1}}
    \hfill\begin{minipage}[t]{0.66\textwidth}
        \raggedright
    }
    {
    \end{minipage}
    \vspace*{\stretch{3}}
    \clearpage
}

% Chapter quote at the start of chapter
% Source: http://tex.stackexchange.com/a/53380
\makeatletter
\newenvironment{chapquote}[2][2em]
{\setlength{\@tempdima}{#1}%
    \def\chapquote@author{#2}%
    \parshape 1 \@tempdima \dimexpr\textwidth-2\@tempdima\relax%
\itshape}
{\par\normalfont\hfill--\ \chapquote@author\hspace*{\@tempdima}\par\bigskip}
\makeatother

% Add syllogism definition
% Source: https://tex.stackexchange.com/questions/577862
\newcommand\syllogism[3][]{%
  \begin{center}
  \def\tmp{#1}%
  \ifx\tmp\empty\else(#1)\quad\fi
  \begin{tabular}{@{}l@{}}
    #2\\\hline#3\quad$\therefore$
  \end{tabular}
  \end{center}
}
